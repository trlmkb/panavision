var throttle=function(t,i,e){var o,n,s,r=null,l=0;e||(e={});var h=function(){l=e.leading===!1?0:(new Date).getTime(),r=null,s=t.apply(o,n),r||(o=n=null)};return function(){var a=(new Date).getTime();l||e.leading!==!1||(l=a);var p=i-(a-l);return o=this,n=arguments,0>=p||p>i?(r&&(clearTimeout(r),r=null),l=a,s=t.apply(o,n),r||(o=n=null)):r||e.trailing===!1||(r=setTimeout(h,p)),s}};+function(t){"use strict";var i=t(window),e=function(i,e){this.$el=i,this.video=this.$el[0],this.playOnceId="",this.ready=!1,this.options=t.extend(!0,{reverse:!1,scrollThrottle:100,seekWithScroll:!0,playOnce:!1},e),this.setupBindings()};e.prototype.initialize=function(){this.cacheHeights(),this.targetTime=this.options.reverse?this.video.duration:0,this.ratio=this.video.duration/(this.windowHeight-this.videoHeight),this.ready=!0},e.prototype.setupBindings=function(){if(this.$el.on("loadedmetadata",t.proxy(this.initialize,this)),this.options.seekWithScroll){var e=throttle(t.proxy(this.onWindowScroll,this),this.options.scrollThrottle);i.on("resize",t.proxy(this.cacheHeights,this)),i.on("scroll",e)}else var e=throttle(t.proxy(this.playVideo,this),this.options.scrollThrottle);1==this.options.playOnce?(i.on("scroll.playonce",e),this.video.on("ended",t.proxy(this.removeScrollBindings,this))):i.on("scroll",e),i.on("blur",t.proxy(this.pauseVideo,this)),i.on("focus",t.proxy(this.playVideo,this)),this.video.play(),this.video.pause()},e.prototype.removeScrollBindings=function(){this.ready=!1,i.unbind("scroll.playonce")},e.prototype.playVideo=function(){this.canPlay()&&this.ready&&0==this.options.seekWithScroll&&this.video.play()},e.prototype.pauseVideo=function(){0==this.options.seekWithScroll&&this.video.pause()},e.prototype.render=function(){this.ready&&this.video.targetTime!=this.targetTime&&this.options.seekWithScroll&&(this.targetTime=this.targetTime.toFixed(4),this.video.targetTime=this.targetTime)},e.prototype.cacheHeights=function(){this.windowHeight=parseInt(i.height()),this.videoHeight=parseInt(this.$el.height())},e.prototype.onWindowScroll=function(){this.playOrRewind()},e.prototype.playOrRewind=function(){if(this.canPlay()){var t=this.videoPosition*this.ratio;this.options.reverse||(t=this.video.duration-t),this.targetTime=t}},e.prototype.canPlay=function(){var t=this.$el.offset().top,e=i.scrollTop(),o=this.windowHeight,n=this.videoHeight,s=function(){return e+o>t+n},r=function(){return t>e};return this.setVideoPosition(t,e),r()&&s()},e.prototype.setVideoPosition=function(t,i){this.videoPosition=t-i},t.fn.playOnScroll=function(i){return this.each(function(){var o=t(this);window.playOnScrollElements.push(new e(o,i)),o.data("playOnScroll",window.playOnScrollElements[window.playOnScrollElements.length-1])}),this}}(jQuery),window.playOnScrollElements=[];var renderLoop=function(){requestAnimationFrame(function(){for(var t=0;t<window.playOnScrollElements.length;t++)window.playOnScrollElements[t].render();renderLoop()})};renderLoop();